<div class="main">
  <mat-dialog-content class="mat-typography">

  <div style="height: 500px; width: 100%">
    {{attributesForFilter.length}}
    <mat-form-field appearance="fill" style="width: 100%">
      <mat-label>Значение</mat-label>
      <input matInput placeholder=""
             [formControl]="attributeValueFilterCtrl"
             [matAutocomplete]="attributeValuesAuto" [autofocus]="true" (keydown.enter)="onAttributeValueSelected();">
      <mat-autocomplete autoActiveFirstOption #attributeValuesAuto="matAutocomplete" [displayWith]="displayFn" (optionSelected)="onAttributeValueSelected()">
        <mat-option *ngFor="let option of attributesList" [value]="option">
          {{option.nameAttribute}}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <div *ngFor="let item of attributesForFilter; let i = index" style="display: flex;margin-bottom: 5px">
      <mat-accordion class="full-width" appearance="fill">
        <mat-expansion-panel>
          <mat-expansion-panel-header [expandedHeight]="'35px'">
            <mat-panel-title>
              {{item.nameAttribute}}
              {{item.allValues.length}}
            </mat-panel-title>
          </mat-expansion-panel-header>

          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Значение</mat-label>
            <input type="text" matInput #filterSearch (input)="filtrationSearch(filterSearch, item.id)">
          </mat-form-field>

          <cdk-virtual-scroll-viewport itemSize="10" class="attributeFilter-viewport" style="height: 100px">
            <mat-checkbox style="display: block" *cdkVirtualFor="let value of item.allValues" [value]="value" (change)="attributeValueChecked($event, item.nameAttribute, value)">{{value}}</mat-checkbox>

            <!--
                       <mat-option  [value]="value" class="multiline-mat-option" (onSelectionChange)="attributeValueChecked($event ,item.nameAttribute,value)">{{value}}</mat-option>
            -->

          </cdk-virtual-scroll-viewport>


          <!-- <mat-label>{{item.nameAttribute}}</mat-label>
           <mat-select multiple [formControl]="attributeValueFilterCtrl" panelClass="select-long-panel">
             &lt;!&ndash;                <mat-select-trigger>&ndash;&gt;

             &lt;!&ndash;                </mat-select-trigger>&ndash;&gt;

             <mat-card style="height: 100px">
               <mat-form-field class="full-width" appearance="fill">
                 {{item.allValues | json}}
                 <mat-label>Поиск</mat-label>
                 <input matInput #filterSearch (input)="filtrationSearch(filterSearch, item.id)">
               </mat-form-field>
               <cdk-virtual-scroll-viewport itemSize="10" class="attributeFilter-viewport">
                 <mat-option *cdkVirtualFor="let value of item.allValues" [value]="value" class="multiline-mat-option" (onSelectionChange)="attributeValueChecked($event ,item.nameAttribute,value)">{{value}}</mat-option>
               </cdk-virtual-scroll-viewport>
             </mat-card>
           </mat-select>-->
          <!--
                  </mat-form-field>
          -->
        </mat-expansion-panel>
      </mat-accordion>
      <button (click)="removeFilter(i)">X</button>
    </div>


  </div>
  </mat-dialog-content>

    <div mat-dialog-actions class="actions-div">
      <button mat-button mat-dialog-close  type="button">Отмена</button>
      <button mat-raised-button color="primary" [mat-dialog-close]="selectedAttributes">Применить</button>
    </div>
</div>
