<div class="mat-headline">
  <div style="float:right; margin-right: 3px">
    <button mat-raised-button (click)="goToEdit(productId)">Редактировать</button>&nbsp;
    <!--<button mat-raised-button *ngIf="!product?.internalCode">В ассортимент</button>-->
  </div>

  <div>
    <span *ngIf="product?.vendor">{{product?.vendor}}</span>
    <span> {{product?.title !== undefined ? product?.title : product.titleLong}}</span>&nbsp;
    <span *ngIf="product?.vendorId"> <button class="btnAsText" (click)="copyVendorId(product.vendorId)">[<strong>{{product.vendorId}}</strong>]</button> </span>
<!--    <mat-icon style="vertical-align:middle;">content_copy</mat-icon>-->
  </div>
</div>

<div class="container">

  <div>
    <mat-card style="padding-top: 0">
      <mat-tab-group style="width:420px" animationDuration="0ms">
        <mat-tab *ngIf="product?.images || product?.localImages" label="Фото">
          <ng-template matTabContent>
            <div style="height: 455px">
              <app-hover-image-slider [imgList]="remoteAndLocalImg"></app-hover-image-slider>
            </div>
          </ng-template>
        </mat-tab>
        <mat-tab *ngIf="product?.image360" label="Фото 360">
          <ng-template matTabContent>
            <!--<iframe width="460" height="440" [src]="safeImg360Url" title="360ImageViewer" allowfullscreen></iframe>-->
          </ng-template>
        </mat-tab>

        <mat-tab *ngIf="product?.videos.length >= 1" label="Видео">
          <ng-template matTabContent>
            <iframe width="460" height="440" [src]="selectedSafeVideo" allowfullscreen></iframe>
            <div *ngIf="safeVideoUrl.length > 1" class="video-btn-wrapper">
              <button mat-flat-button class="mat-elevation-z2 video-btn" *ngFor="let video of safeVideoUrl;let i = index" (click)="selectedSafeVideo = video">
                {{i+1}}
              </button>
            </div>

          </ng-template>
        </mat-tab>
      </mat-tab-group>
    </mat-card>

    <mat-accordion  *ngIf="(product?.netto | json) != '{}'">
      <mat-expansion-panel expanded style="margin-right: 10px; margin-top: 10px;" hideToggle>
        <mat-expansion-panel-header #panelH (click)="panelH._toggle()" style="cursor: default">
          <mat-panel-title>Нетто</mat-panel-title>
          <mat-panel-description><mat-icon>format_size</mat-icon> {{product?.netto?.packQty}} {{product?.netto?.type}}</mat-panel-description>
        </mat-expansion-panel-header>
        <app-package-card [pack]="product?.netto"></app-package-card>
      </mat-expansion-panel>
    </mat-accordion>

    <div style="margin-top: 10px">
      <mat-accordion>
        <mat-expansion-panel *ngFor="let pack of product?.packages">
          <mat-expansion-panel-header [expandedHeight]="'35px'">
            <mat-panel-title>
              <span>{{pack.packQty}}<span *ngIf="pack.type">{{' '}}{{pack.type}}</span> [{{pack.barcode ? pack.barcode : 'Штрихкод отсутствует'}}]</span>
            </mat-panel-title>
          </mat-expansion-panel-header>
          <app-package-card [pack]="pack"></app-package-card>
        </mat-expansion-panel>
      </mat-accordion>
    </div>

    <div *ngIf="product?.documents && product?.documents.length > 0" style="margin-top: 10px">
      <mat-accordion>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>Документы / Сертификаты</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="cardsToCenter">
            <div class="cards"><app-document-card *ngFor="let doc of productDocuments" [document]="doc"></app-document-card></div>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
    </div>

<!--    <mat-card style="margin-top: 10px" *ngIf="product?.documents && product?.documents.length > 0">
      <mat-card-subtitle><h2>Документы</h2></mat-card-subtitle>
      <div class="cardsToCenter">
        <div class="cards"><app-document-card *ngFor="let doc of productDocuments" [document]="doc"></app-document-card></div>
      </div>
    </mat-card>-->
  </div>

  <div style="width: 100%">
    <mat-card>
      <mat-card-subtitle>
        <div class="card-container">
          <h2>О товаре</h2>
          <h4 *ngIf="product?.internalCode">арт. <span style="font-size: 1.5em">{{product.internalCode}}</span></h4>
        </div>
      </mat-card-subtitle>
      <div [innerHTML]="product?.description"></div>
      <ul>
        <li *ngIf="product?.country">Страна производства - {{product.country}} <span *ngIf="product.countryCode">(Код {{product.countryCode}})</span></li>
        <li *ngIf="product?.vendorId">Артикул поставщика - {{product.vendorId}}</li>
        <li *ngIf="product?.vendor">Бренд - {{product.vendor}}</li>
        <li *ngIf="product?.supplierName">Поставщик - {{product.supplierName}}</li>
      </ul>
    </mat-card>

    <mat-card style="margin-top: 10px;" *ngIf="product?.attributes && product?.attributes.length > 0">
      <mat-card-subtitle><h2>Характеристики</h2></mat-card-subtitle>
      <table mat-table [dataSource]="dataSource" class="full-width">
        <!-- Etim Column -->
        <ng-container matColumnDef="etim">
          <th mat-header-cell *matHeaderCellDef> Значение </th>
          <td mat-cell *matCellDef="let row">
            <mat-icon *ngIf="row.etimFeature" matTooltip="{{row.etimFeature}}">explicit</mat-icon>
            <mat-icon *ngIf="!row.etimFeature" >{{row.fixed ? 'check_circle' : 'radio_button_unchecked'}}</mat-icon>
          </td>
        </ng-container>
        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef> Характеристика </th>
          <td mat-cell *matCellDef="let row"> {{row.attributeName}} </td>
        </ng-container>
        <!-- Value Column -->
        <ng-container matColumnDef="value">
          <th mat-header-cell *matHeaderCellDef> Значение </th>
          <td mat-cell *matCellDef="let row"> {{row.value}} <span *ngIf="row.unit" class="unitMark">{{row.unit}}</span></td>
        </ng-container>

        <!-- action Column -->
        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let item">
            <!--<button mat-icon-button matTooltip="Заменить" (click)="swapItem(item.attributeName, item.attributeId)">
              <mat-icon>swap_horiz</mat-icon>
            </button>&nbsp;
            <button mat-icon-button matTooltip="Удалить" [disabled]="isDelBtnDisabled" (click)="deleteAttr(item.attributeName, item.attributeId)">
              <mat-icon>delete</mat-icon>
            </button>-->
          </td>
        </ng-container>
        <tr mat-row *matRowDef="let row; columns: displayedAttrColumns;"></tr>
      </table>
    </mat-card>

  </div>
</div>
