<div class="full-width" style="display: flex; justify-content: space-between; padding-right: 20px;">
  <h3>{{product?.supplierId == undefined ? "Добавление нового товара" : "Редактирование " + product?.title}}</h3>
  <div style="vertical-align: bottom; margin: auto 0;">
    <button mat-flat-button color="primary" (click)="submitProduct()">Сохранить</button>
  </div>
</div>

<div class="uploadImageContainer">

  <div>
    <mat-card style="padding-top: 0">
      <mat-tab-group style="width:465px" animationDuration="0ms">
        <mat-tab  label="Фото">
          <ng-template matTabContent>
            <button mat-button (click)="fileInput.click()" class="mat-elevation-z2" style="margin:10px">
              <mat-icon>cloud_upload</mat-icon>
              Загрузить
              <input #fileInput type="file" multiple="" (change)="onFileChange($event)" style="display:none;" />
            </button>

            <div>
              <div class="thumbnail" *ngFor="let img of product?.images" >
                <img [src]="img" style="object-fit: cover;height:200px; width: 200px; margin-left:10px">
                <button (click)="removeImage(img)">X</button>
              </div>
            </div>

            <div class="img-wrap" *ngFor="let img of imagesToUpload">
              <img  [src]="img" style="object-fit: cover;height:200px; width: 200px">
            </div>

<!--            <app-hover-image-slider [imgList]="product.images"></app-hover-image-slider>-->

          </ng-template>
        </mat-tab>
        <!--        *ngIf="product.image360"-->
        <mat-tab label="Фото 360">
          <ng-template matTabContent>
            <mat-form-field class="form-full-width" appearance="fill">
              <mat-label>Ссылка на фото 360</mat-label>
              <input matInput name="image360" [(ngModel)]="product.image360">
            </mat-form-field>
          </ng-template>
        </mat-tab>

        <mat-tab  label="Видео">
          <ng-template matTabContent>
            <mat-form-field class="form-full-width" appearance="fill">
              <mat-label>Ссылка на видео</mat-label>
              <mat-chip-list #chipList aria-label="Fruit selection">
                <mat-chip *ngFor="let item of product.videos" (removed)="removeVideo(item)">
                  {{item}}
                  <button matChipRemove>
                    <mat-icon>cancel</mat-icon>
                  </button>
                </mat-chip>
                <input placeholder=""
                       [matChipInputFor]="chipList"
                       [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                       [matChipInputAddOnBlur]="true"
                       (matChipInputTokenEnd)="addVideo($event)">
              </mat-chip-list>
            </mat-form-field>
          </ng-template>
        </mat-tab>
      </mat-tab-group>
    </mat-card>



  </div>





  <div style="width: 100%">

    <mat-card style="padding-top: 0">
      <mat-tab-group  animationDuration="0ms">
        <mat-tab  label="О товаре">
          <ng-template matTabContent>
            <mat-form-field appearance="fill" class="full-width" *ngIf="!product.supplierName">
              <mat-label>Поставщик</mat-label>
              <input matInput placeholder=""
                     [formControl]="searchSupplierCtrl"
                     [matAutocomplete]="auto">
              <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" [displayWith]="displayFn">
                <mat-option *ngFor="let option of supplierList" [value]="option">
                  {{option.supplierName}}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>

            <mat-form-field appearance="fill" class="form-full-width">
              <mat-label>Наименование</mat-label>
              <input matInput name="title" [(ngModel)]="product.title" required>
            </mat-form-field>

            <mat-form-field appearance="fill" class="form-full-width">
              <mat-label>Полное наименование</mat-label>
              <input matInput name="titleLong" [(ngModel)]="product.titleLong">
            </mat-form-field>

            <mat-form-field appearance="fill" class="form-full-width">
              <mat-label>Описание</mat-label>
              <textarea matInput name="description" [(ngModel)]="product.description" style="min-height:100px"></textarea>
            </mat-form-field>

            <div class="formBlockDouble">
              <mat-form-field appearance="fill" class="form-full-width">
                <mat-label>Вендор</mat-label>
                <input matInput name="vendor" [(ngModel)]="product.vendor">
              </mat-form-field>&nbsp;

              <mat-form-field appearance="fill" class="form-full-width">
                <mat-label>Вендор ID</mat-label>
                <input matInput name="vendorId" [(ngModel)]="product.vendorId">
              </mat-form-field>
            </div>

            <div class="formBlockDouble">
              <mat-form-field appearance="fill" class="form-full-width">
                <mat-label>Страна производства</mat-label>
                <input matInput name="country" [(ngModel)]="product.country">
              </mat-form-field>&nbsp;
              <mat-form-field appearance="fill" class="form-full-width">
                <mat-label>Код страны</mat-label>
                <input matInput name="countryId" [(ngModel)]="product.countryCode">
              </mat-form-field>
            </div>


            <mat-form-field class="form-full-width" appearance="fill">
              <mat-label>ГТД</mat-label>
              <mat-chip-list #chipList aria-label="Fruit selection">
                <mat-chip *ngFor="let item of product.gtd" (removed)="removeGTD(item)">
                  {{item}}
                  <button matChipRemove>
                    <mat-icon>cancel</mat-icon>
                  </button>
                </mat-chip>
                <input placeholder=""
                       [matChipInputFor]="chipList"
                       [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                       [matChipInputAddOnBlur]="true"
                       (matChipInputTokenEnd)="addGTD($event)">
              </mat-chip-list>
            </mat-form-field>
          </ng-template>
        </mat-tab>

        <mat-tab label="Характеристики">
          <ng-template matTabContent>
            <div style="max-height: 500px; overflow-y: auto">


              <table #table mat-table [dataSource]="attrDataSource" class="mat-elevation-z8; form-full-width" >

                <!-- attributeKey Column -->
                <ng-container matColumnDef="attributeKey" appearance="fill" class="full-width">
                  <th mat-header-cell *matHeaderCellDef> Аттрибут </th>
                  <td mat-cell *matCellDef="let row">{{row.attributeName}}</td>
                </ng-container>

                <!-- attributeValue Column -->
                <ng-container matColumnDef="attributeValue" appearance="fill" class="full-width">
                  <th mat-header-cell *matHeaderCellDef> Значение </th>
                  <td mat-cell *matCellDef="let row">{{row.value}}</td>
                </ng-container>

                <!-- actions Column -->
                <ng-container matColumnDef="actions" appearance="fill" class="full-width">
                  <th mat-header-cell *matHeaderCellDef>
                    <button mat-icon-button class="mat-elevation-z2" (click)="AddNewRowAttribute()" >
                      <mat-icon>add</mat-icon>
                    </button>
                  </th>
                  <td mat-cell *matCellDef="let row">

                    <button mat-icon-button matTooltip="Редактировать" class="mat-elevation-z2" (click)="editAttrRow(row)">
                      <mat-icon>edit</mat-icon>
                    </button>

                    <button mat-icon-button matTooltip="Удалить" class="mat-elevation-z2" (click)="deleteAttrRow(row)">
                      <mat-icon>delete</mat-icon>
                    </button>
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="attributeColumns; sticky: true" ></tr>
                <tr mat-row *matRowDef="let row; columns: attributeColumns;"></tr>

              </table>


            </div>

          </ng-template>
        </mat-tab>

        <mat-tab  label="Упаковка">
          <ng-template matTabContent>
            <app-package-card [pack]="product.netto"></app-package-card>


            <table #table mat-table [dataSource]="packDataSource" class="mat-elevation-z8; form-full-width" >

              <!-- attributeKey Column -->
              <ng-container matColumnDef="package" appearance="fill" class="full-width">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let row">
                  <app-package-card [pack]="row"></app-package-card>
                </td>
              </ng-container>


              <!-- actions Column -->
              <ng-container matColumnDef="actions" appearance="fill" class="full-width">
                <th mat-header-cell *matHeaderCellDef>
                  <button mat-icon-button class="mat-elevation-z2" (click)="AddNewRowAttribute()" >
                    <mat-icon>add</mat-icon>
                  </button>
                </th>
                <td mat-cell *matCellDef="let row">

                  <button mat-icon-button matTooltip="Редактировать" class="mat-elevation-z2" (click)="editAttrRow(row)">
                    <mat-icon>edit</mat-icon>
                  </button>

                  <button mat-icon-button matTooltip="Удалить" class="mat-elevation-z2" (click)="deleteAttrRow(row)">
                    <mat-icon>delete</mat-icon>
                  </button>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="packageColumns; sticky: true" ></tr>
              <tr mat-row *matRowDef="let row; columns: packageColumns;"></tr>

            </table>


<!--            <mat-accordion  *ngIf="product?.netto.packQty">-->
<!--              <mat-expansion-panel disabled expanded style="margin-right: 10px; margin-bottom: 10px; margin-top: 10px">-->
<!--                <app-package-card [pack]="product.netto"></app-package-card>-->
<!--              </mat-expansion-panel>-->
<!--            </mat-accordion>-->

<!--            <mat-accordion>-->
<!--              <mat-expansion-panel *ngFor="let pack of product?.package">-->
<!--                <mat-expansion-panel-header>-->
<!--                  <mat-panel-title>-->
<!--                    <span>{{pack.packQty ? pack.packQty : 1}} {{pack.type}} [{{pack.barcode}}]</span>-->
<!--                  </mat-panel-title>-->
<!--                  <mat-panel-description>-->

<!--                  </mat-panel-description>-->
<!--                </mat-expansion-panel-header>-->
<!--                <app-package-card [pack]="pack"></app-package-card>-->
<!--              </mat-expansion-panel>-->
<!--            </mat-accordion>-->
          </ng-template>
        </mat-tab>

        <mat-tab  label="Документы">
          <ng-template matTabContent>
            <mat-list>
              <mat-list-item *ngFor="let d of product.documents" style="height: auto">
                <div mat-line><strong>{{d.type}}</strong> <span style="font-style: italic">  ({{d.startDate | date:'dd-MM-yyyy'}} - {{d.endDate | date:'dd-MM-yyyy'}})</span></div>
                <div mat-line>{{d.certTitle}}</div>
                <a mat-icon-button class="mat-elevation-z2" *ngIf="d.url" style="color:black" href="{{d.url}}" target="_blank"><mat-icon>download</mat-icon></a>
              </mat-list-item>
            </mat-list>
          </ng-template>
        </mat-tab>



      </mat-tab-group>
    </mat-card>




<!--    <mat-card style="margin-top: 10px;" >-->
<!--      <mat-card-subtitle><h2>Документы</h2></mat-card-subtitle>-->
<!--      <mat-list>-->
<!--        <mat-list-item *ngFor="let d of product.documents" style="height: auto">-->
<!--          <div mat-line><strong>{{d.type}}</strong> <span style="font-style: italic">  ({{d.startDate | date:'dd-MM-yyyy'}} - {{d.endDate | date:'dd-MM-yyyy'}})</span></div>-->
<!--          <div mat-line>{{d.certTitle}}</div>-->
<!--          <a mat-icon-button class="mat-elevation-z2" *ngIf="d.url" style="color:black" href="{{d.url}}" target="_blank"><mat-icon>download</mat-icon></a>-->
<!--        </mat-list-item>-->
<!--      </mat-list>-->
<!--    </mat-card>-->



</div>







<!--<form>-->

<!--  <mat-stepper #stepper>-->
<!--    <mat-step label="Основное">-->
<!--        <ng-template matStepLabel>Основное</ng-template>-->

<!--      <mat-form-field appearance="fill" class="full-width">-->
<!--        <mat-label>Поставщик</mat-label>-->
<!--        <input matInput placeholder=""-->
<!--               [formControl]="searchSupplierCtrl"-->
<!--               [matAutocomplete]="auto">-->
<!--        <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">-->
<!--          <mat-option *ngFor="let option of supplierList" [value]="option">-->
<!--            {{option.supplierName}}-->
<!--          </mat-option>-->
<!--        </mat-autocomplete>-->
<!--      </mat-form-field>-->

<!--        <mat-form-field appearance="fill" class="form-full-width">-->
<!--          <mat-label>Наименование</mat-label>-->
<!--          <input matInput name="title" [(ngModel)]="product.title" required>-->
<!--        </mat-form-field>-->

<!--        <mat-form-field appearance="fill" class="form-full-width">-->
<!--          <mat-label>Полное наименование</mat-label>-->
<!--          <input matInput name="titleLong" [(ngModel)]="product.titleLong">-->
<!--        </mat-form-field>-->

<!--        <mat-form-field appearance="fill" class="form-full-width">-->
<!--          <mat-label>Описание</mat-label>-->
<!--          <textarea matInput name="description" [(ngModel)]="product.description" style="max-height: 150px"></textarea>-->
<!--        </mat-form-field>-->

<!--        <mat-form-field appearance="fill" class="form-full-width">-->
<!--          <mat-label>Вендор</mat-label>-->
<!--          <input matInput name="vendor" [(ngModel)]="product.vendor">-->
<!--        </mat-form-field>-->

<!--        <mat-form-field appearance="fill" class="form-full-width">-->
<!--          <mat-label>Страна производства</mat-label>-->
<!--          <input matInput name="country" [(ngModel)]="product.country">-->
<!--        </mat-form-field>-->

<!--      <mat-form-field class=form-full-width appearance="fill">-->
<!--        <mat-label>ГТД</mat-label>-->
<!--        <mat-chip-list #chipList aria-label="Fruit selection">-->
<!--          <mat-chip *ngFor="let item of product.gtd" (removed)="removeGTD(item)">-->
<!--            {{item}}-->
<!--            <button matChipRemove>-->
<!--              <mat-icon>cancel</mat-icon>-->
<!--            </button>-->
<!--          </mat-chip>-->
<!--          <input placeholder=""-->
<!--                 [matChipInputFor]="chipList"-->
<!--                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"-->
<!--                 [matChipInputAddOnBlur]="true"-->
<!--                 (matChipInputTokenEnd)="addGTD($event)">-->
<!--        </mat-chip-list>-->
<!--      </mat-form-field>-->

<!--        <div>-->
<!--          <button mat-button matStepperNext>Далее</button>-->
<!--        </div>-->
<!--    </mat-step>-->
<!--    <mat-step label="Характеристики">-->

<!--      <div style="height: 500px; overflow-y: auto">-->


<!--          <table #table mat-table [dataSource]="attrDataSource" class="mat-elevation-z8; form-full-width" >-->

<!--            &lt;!&ndash; attributeKey Column &ndash;&gt;-->
<!--            <ng-container matColumnDef="attributeKey">-->
<!--              <th mat-header-cell *matHeaderCellDef> Аттрибут </th>-->
<!--              <td mat-cell *matCellDef="let row">{{row.attributeName}}</td>-->
<!--            </ng-container>-->

<!--            &lt;!&ndash; attributeValue Column &ndash;&gt;-->
<!--            <ng-container matColumnDef="attributeValue">-->
<!--              <th mat-header-cell *matHeaderCellDef> Значение </th>-->
<!--              <td mat-cell *matCellDef="let row">{{row.value}}</td>-->
<!--            </ng-container>-->

<!--            &lt;!&ndash; actions Column &ndash;&gt;-->
<!--            <ng-container matColumnDef="actions">-->
<!--              <th mat-header-cell *matHeaderCellDef>-->
<!--                <button mat-icon-button class="mat-elevation-z2" (click)="AddNewRow()">-->
<!--                  <mat-icon>add</mat-icon>-->
<!--                </button>-->
<!--              </th>-->
<!--              <td mat-cell *matCellDef="let row">-->

<!--                <button mat-icon-button class="material-icons app-toolbar-menu save-button"-->
<!--                        matTooltip="Edit" color="primary" (click)="editAttrRow(row)">-->
<!--                  <mat-icon>edit</mat-icon>-->
<!--                </button>-->

<!--                <button mat-icon-button class="material-icons app-toolbar-menu delete-button"-->
<!--                        matTooltip="Delete" color="warn" (click)="deleteAttrRow(row)">-->
<!--                  <mat-icon>delete</mat-icon>-->
<!--                </button>-->
<!--              </td>-->
<!--            </ng-container>-->

<!--            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" ></tr>-->
<!--            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>-->

<!--          </table>-->


<!--      </div>-->
<!--      <div>-->
<!--        <button mat-button matStepperNext>Далее</button>-->
<!--      </div>-->
<!--    </mat-step>-->
<!--    <mat-step label="Медиа">-->
<!--      <mat-card>-->
<!--        <mat-card-subtitle>Фото</mat-card-subtitle>-->
<!--        <mat-card-content>-->
<!--            <input id="file" type="file" class="form-control-file" multiple=""-->
<!--                   (change)="onFileChange($event)">-->

<!--            <div *ngFor='let url of imagesToUpload'>-->
<!--              <img [src]="url" width="200px">-->
<!--              <button type="button"  (click)="removeImage(url)">Remove</button>-->
<!--            </div>-->
<!--        </mat-card-content>-->
<!--      </mat-card>-->

<!--      <mat-card>-->
<!--        <mat-card-subtitle>Видео</mat-card-subtitle>-->
<!--        <mat-card-content>-->

<!--        </mat-card-content>-->
<!--      </mat-card>-->


<!--      <button mat-button matStepperPrevious>Back</button>-->
<!--      <button mat-button matStepperNext>Next</button>-->
<!--    </mat-step>-->
<!--    <mat-step>-->
<!--      <ng-template matStepLabel>Предпросмотр</ng-template>-->
<!--      <p>You are now done.</p>-->
<!--      <button mat-button (click)="submitProduct()">Сохранить</button>-->
<!--      <div>-->
<!--        <button mat-button matStepperPrevious>Back</button>-->
<!--        <button mat-button (click)="stepper.reset()">Reset</button>-->
<!--      </div>-->
<!--    </mat-step>-->
<!--</mat-stepper>-->

<!--</form>-->
