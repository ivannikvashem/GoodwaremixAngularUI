<h3>{{product?.supplierId == undefined ? "Добавление нового товара" : "Редактирование " + product?.title}}</h3>

<form>

  <mat-stepper #stepper>
    <mat-step label="Основное">
        <ng-template matStepLabel>Основное</ng-template>

      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Поставщик</mat-label>
        <input matInput placeholder=""
               [formControl]="searchSupplierCtrl"
               [matAutocomplete]="auto">
        <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
          <mat-option *ngFor="let option of supplierList" [value]="option">
            {{option.supplierName}}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>

        <mat-form-field appearance="fill" class="form-full-width">
          <mat-label>Наименование</mat-label>
          <input matInput name="title" [(ngModel)]="product.title" required>
        </mat-form-field>

        <mat-form-field appearance="fill" class="form-full-width">
          <mat-label>Полное наименование</mat-label>
          <input matInput name="titleLong" [(ngModel)]="product.titleLong">
        </mat-form-field>

        <mat-form-field appearance="fill" class="form-full-width">
          <mat-label>Описание</mat-label>
          <textarea matInput name="description" [(ngModel)]="product.description" style="max-height: 150px"></textarea>
        </mat-form-field>

        <mat-form-field appearance="fill" class="form-full-width">
          <mat-label>Вендор</mat-label>
          <input matInput name="vendor" [(ngModel)]="product.vendor">
        </mat-form-field>

        <mat-form-field appearance="fill" class="form-full-width">
          <mat-label>Страна производства</mat-label>
          <input matInput name="country" [(ngModel)]="product.country">
        </mat-form-field>

      <mat-form-field class=form-full-width appearance="fill">
        <mat-label>ГТД</mat-label>
        <mat-chip-list #chipList aria-label="Fruit selection">
          <mat-chip *ngFor="let item of product.gtd" (removed)="removeGTD(item)">
            {{item}}
            <button matChipRemove>
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip>
          <input placeholder=""
                 [matChipInputFor]="chipList"
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                 [matChipInputAddOnBlur]="true"
                 (matChipInputTokenEnd)="addGTD($event)">
        </mat-chip-list>
      </mat-form-field>

        <div>
          <button mat-button matStepperNext>Далее</button>
        </div>
    </mat-step>
    <mat-step label="Характеристики">

      <div style="height: 500px; overflow-y: auto">


          <table #table mat-table [dataSource]="attrDataSource" class="mat-elevation-z8; form-full-width" >

            <!-- attributeKey Column -->
            <ng-container matColumnDef="attributeKey">
              <th mat-header-cell *matHeaderCellDef> Аттрибут </th>
              <td mat-cell *matCellDef="let row">{{row.attributeName}}</td>
            </ng-container>

            <!-- attributeValue Column -->
            <ng-container matColumnDef="attributeValue">
              <th mat-header-cell *matHeaderCellDef> Значение </th>
              <td mat-cell *matCellDef="let row">{{row.value}}</td>
            </ng-container>

            <!-- actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>
                <button mat-icon-button class="mat-elevation-z2" (click)="AddNewRow()">
                  <mat-icon>add</mat-icon>
                </button>
              </th>
              <td mat-cell *matCellDef="let row">

                <button mat-icon-button class="material-icons app-toolbar-menu save-button"
                        matTooltip="Edit" color="primary" (click)="editAttrRow(row.attributeId, row.attributeName, row.value)">
                  <mat-icon>edit</mat-icon>
                </button>

                <button mat-icon-button class="material-icons app-toolbar-menu delete-button"
                        matTooltip="Delete" color="warn" (click)="deleteAttrRow(row)">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" ></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

          </table>


      </div>
      <div>
        <button mat-button matStepperNext>Далее</button>
      </div>
    </mat-step>
    <mat-step label="Медиа">
      <mat-card>
        <mat-card-subtitle>Фото</mat-card-subtitle>
        <mat-card-content>
            <input id="file" type="file" class="form-control-file" multiple=""
                   (change)="onFileChange($event)">

            <div *ngFor='let url of imagesToUpload'>
              <img [src]="url" width="200px">
              <button type="button"  (click)="removeImage(url)">Remove</button>
            </div>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-subtitle>Видео</mat-card-subtitle>
        <mat-card-content>

        </mat-card-content>
      </mat-card>


      <button mat-button matStepperPrevious>Back</button>
      <button mat-button matStepperNext>Next</button>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel>Предпросмотр</ng-template>
      <p>You are now done.</p>
      <button mat-button (click)="submitProduct()">Сохранить</button>
      <div>
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button (click)="stepper.reset()">Reset</button>
      </div>
    </mat-step>
</mat-stepper>

</form>
